---
title: find 与xargs命令使用
date: 2016-12-12 17:28:50
tags: [linux]
categories: linux
---

# find 与xargs命令使用
## find
find命令是一个无处不在命令，是linux中最有用的命令之一。find命令用于：在一个目录（及子目录）中搜索文件，你可以指定一些匹配条件，如按文件名、文件类型、用户甚至是时间戳查找文件。

find命令常用的格式如下：

**find   path   -option   [   -print ]   [ -exec   -ok   command ]   {} \;**

常用命令详解：

* path：find命令所查找的目录路径
* -options：指定find命令的常用选项
* -print：find命令将匹配的文件输出到标准输出
* -exec：find命令对匹配的文件执行该参数所给出的shell命令。相应命令的形式为'command' {  } \;
* -ok：和-exec的作用相同，只不过以一种更为安全的模式来执行该参数所给出的shell命令，在执行每一个命令之前，都会给出提示，让用户来确定是否执行。

其中options中的常用选项：

*  -name：按照文件名查找文件，支持正则表达式。例如：```find . -name “test*”```，在当前目录以及子目录查找名称为包含test的文件
*  -perm：按照文件的权限查找文件。例如：```find . -perm 700 ```，在当前目录以及子目录下查找文件权限为当前用户可读、可写、可执行的文件。
*  -prune：查看的时候忽略某个文件夹。例如：```find .  -path "/test/prune" -prune```，在当前目录查找，且不在/test/prune目录下的文件。
*  -type：在当前目录以及子目录下查找某个类型的文件。例如：```find . -type l ```，在当前目录以及子目录下查找是软链接文件。

## find与xargs
在使用find命令的-exec选项处理匹配到的文件时， find命令将所有匹配到的文件一起传递给exec执行。但有些系统对能够传递给exec的命令长度有限制，这样在find命令运行几分钟之后，就会出现溢出错误。错误信息通常是“参数列太长”或“参数列溢出”。这就是xargs命令的用处所在，特别是与find命令一起使用。

find命令把匹配到的文件传递给xargs命令，而xargs命令每次只获取一部分文件而不是全部，不像-exec选项那样。这样它可以先处理最先获取的一部分文件，然后是下一批，并如此继续下去。

在有些系统中，使用-exec选项会为处理每一个匹配到的文件而发起一个相应的进程，并非将匹配到的文件全部作为参数一次执行；这样在有些情况下就会出现进程过多，系统性能下降的问题，因而效率不高；

而使用xargs命令则只有一个进程。另外，在使用xargs命令时，究竟是一次获取所有的参数，还是分批取得参数，以及每一次获取参数的数目都会根据该命令的选项及系统内核中相应的可调参数来确定。

例如：```find . -type f  | xargs file``` 查找系统中的每一个普通文件，然后使用xargs命令来测试它们分别属于哪类文件。

```find . -name "test*"  | xargs echo "" >test.log``` 在当前目录以及子目录中查找包含test的文件，且把相关信息写到test.log中

```find . -type f -print | xargs grep "test"``` 用grep命令在所有的普通文件中搜索test这个词