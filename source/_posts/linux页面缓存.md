---
title: Linux页面缓存
date: 2016-11-26 10:47:39
tags: [linux]
categories: linux
---
# Linux页面缓存

## 虚拟内存机制
虚拟内存的机制是将逻辑的线性地址映射为物理线性地址。如下图所示：
![image](/images/inode/inode1.jpg)

具体流程如下：
![image](/images/inode/inode2.jpg)

### 虚拟内存好处
 操作系统在分配内存的时候，并不想上图所示，那样一个字节一个字节地访问，而是分配好适当的大小（4KB）并传递给进程，这样的一个内存块称为“页面”，进程要求分配内存时，操作系统就分配足够的页面（至少一个）并将其传递给进程。
 
 那么虚拟内存的好处是：

 - 具体让进程更容易地访问内存等好处
 - 操作系统在内核将内存抽象化
 - 操作系统以页面为单位分配物理内存并管理
 - 交换文件功能，当物理内存不足时，将次级存储（主要是磁盘）看成内存，以从表面上解决内存不足
 
 
## Linux 页面缓存原理
 
 操作系统能够让已分配的页面一直维持在这一状态。
 
![image](/images/inode/inode3.jpg)
 
 进程1访问磁盘数据时， 操作系统首先从磁盘中读取4KB的块，读出的内容存放在内存中。然后操作系统将该内存的地址（转化为虚拟地址后）告诉进程，然后由进程访问内存。进程1读取完数据后，虽然读出的数据已全部处理完毕而不再需要这块内存，但不会把3的内存释放掉，而是保留下来。下次其他进程（进程2）想访问同一块磁盘的数据时，就可以直接访问留下来的页面了。

###  页面缓存效果
linux每次从磁盘读取数据时，一定会访问一次内存， 而且一定会缓存下来。因此，第二次访问速度就更快了。其他现在操作系统也拥有同样的页面缓存机制（Windows机器大家经常重启，但实际上不重启，读取的数据更快）。

#### LRU
所有从磁盘中读取的数据都会被操作系统缓存，要是内存不够用怎么办？Linux页面缓存管理采用LRU（淘汰最久不适用的文件）




